# Chrony configuration file (lab-configured)
# Environment: CentOS Linux 9
# Purpose: NTP client + optional NTP server for local networks

# Use public NTP servers from the pool.ntp.org project
server 0.pool.ntp.org iburst
server 1.pool.ntp.org iburst
server 2.pool.ntp.org iburst
server 3.pool.ntp.org iburst

# Additional reliable NTP servers
server time.nist.gov iburst
server time.google.com iburst
server time.cloudflare.com iburst

# Configure polling intervals
minpoll 4
maxpoll 10

# Maximum allowed offset
maxdistance 16.0

# Step the system clock if offset is larger than 1 second
makestep 1.0 3

# Allow NTP client access from local networks
allow 192.168.0.0/16
allow 10.0.0.0/8
allow 172.16.0.0/12

# Serve time even if not synchronized to a time source
local stratum 10

# Specify file containing keys for NTP authentication
keyfile /etc/chrony.keys

# Get TAI-UTC offset and leap seconds from the system tz database
leapsectz right/UTC

# Enable kernel synchronization of the real-time clock (RTC)
rtcsync

# Specify the drift file location
driftfile /var/lib/chrony/drift

# Enable logging of time adjustment
logchange 0.5

# Dump measurements when daemon exits
dumponexit
dumpdir /var/lib/chrony

# Specify the maximum rate of messages sent to syslog
maxupdateskew 100.0

# Enable hardware timestamping if available
hwtimestamp *

# Specify directory for log files
logdir /var/log/chrony

# Select which information is logged
log measurements statistics tracking

# Increase logging for server operations (added during NTP server config step)
log measurements statistics tracking refclocks tempcomp

# Additional step tuning line appended during troubleshooting step
makestep 0.1 3
